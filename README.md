## Полученное задание

Изучение типовых ошибок и принципов поиска уязвимостей в программном обеспечении без исходных кодов. Одним из наиболее распространенных способов поиска ошибок и уязвимостей в программном обеспечении в условиях отсутствия исходного кода является фаззинг. В данной лабораторной работе предлагается осуществить мутационный фаззинг формата файла. Так как формат конфигурационного файла не известен, но есть пример правильного файла, то следует осуществлять фаззинг путем модификации (мутации) оригинального файла. Разрабатываемый фаззер должен иметь режим работы, основанный на осуществлении мутаций входных данных с учетом покрытия кода программы.

В ходе выполнения лабораторной работы необходимо выполнить следующие действия:
1.  Изучить основные типы ошибок в программном обеспечении (целочисленное переполнение, отсутствие проверки длины копируемых данных, переполнение буфера и другие).
2.  Получить у преподавателя файлы в соответствии со своим вариантом.
3.  Реализовать программу, осуществляющую фаззинг формата файла. Реализованная программа должна осуществлять следующие действия:
    * осуществлять изменение оригинального файла (однобайтовая замена, замена нескольких байт, дозапись в файл);
    * заменять байты на граничные значения (0x00, 0xFF, 0xFFFF, 0xFFFFFF, 0xFFFFFFFF, 0xFFFF/2, 0xFFFF/2+1, 0xFFFF/2-1 и т.д.);
    * иметь автоматический режим работы, при котором производится последовательная замена байт в файле;
    * находить в файле символы, разделяющие поля (“,:=;”);
    * расширять значения полей в файле (дописывать в конец, увеличивать длину строк в файле);
    * осуществлять запуск исследуемой программы;
    * используя средство динамической бинарной инструментации (DBI) (Intel Pin / DynamoRIO) осуществлять измерение покрытия кода во время фаззинга;
    * реализовать режим работы фаззера с обратной связью на основе покрытия кода, основанный на сохранении измененных байт в файле с учетом их влияния на покрытие кода программы;
    * обнаруживать возникновение ошибки в исследуемом приложении;
    * получать код ошибки и состояние стека и регистров на момент возникновения ошибки;
    * логировать в файл информацию о произошедших ошибках и соответствующих им входных параметрах (произведенные замены).
4.  Разработать IDC/IDAPython-скрипт, осуществляющий следующие действия:
    * поиск в программе функций ввода данных (fread, fscanf, read, fgets, …);
    * поиск вызовов небезопасных функций (strcpy, sprintf, strncpy, memcpy, memmove, …).
    Разработанный IDC/IDAPython-скрипт должен выводить следующую информацию:
    * название найденной функции;
    * адрес, откуда вызывается данная функция.
5.  Используя разработанную программу для фаззинга формата файлов осуществить поиск в выданной программе уязвимости (целочисленное переполнение, отсутствие проверки длины данных), приводящей к переполнению буфера.
6.  Сформировать файл, приводящий к краху исследуемого приложения.
7.  Изучить с использованием дизассемблера и отладчика структуру программы и найти участок кода с уязвимостью.
8.  Провести исследование найденной уязвимости и условий ее эксплуатации.

## Реализация

Описание реализации представлено в [отчете](отчет.pdf).
